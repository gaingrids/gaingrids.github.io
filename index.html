<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GainGrid Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* ===== EXACT SAME CSS AS YOUR ORIGINAL ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --deep-purple: #5B2E8A;
            --vivid-magenta: #E33D7A;
            --soft-pink: #FF98BD;
            --electric-blue: #4AA3FF;
            --bg-dark: #0F0F14;
            --bg-panel: #0B0B0D;
            --text-secondary: #9AA0A6;
            --gcoin-gold: #FFC857;
            --white: #FFFFFF;
            --spacing-base: 8px;
            --radius-xs: 6px;
            --radius-sm: 12px;
            --radius-md: 16px;
            --radius-lg: 24px;
        }

        html, body {
            width: 100%;
            height: 100%;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-dark);
            color: var(--white);
            overflow-x: hidden;
        }

        .app-container {
            width: 100%;
            min-height: 100%;
            background: var(--bg-dark);
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .app-header {
            width: 100%;
            background: var(--bg-panel);
            padding: calc(var(--spacing-base) * 2) calc(var(--spacing-base) * 3);
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(12px);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-base) * 1.5);
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        .app-title {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--deep-purple), var(--vivid-magenta));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .balance-chip {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-base) * 1);
            background: linear-gradient(135deg, rgba(91, 46, 138, 0.3), rgba(227, 61, 122, 0.3));
            padding: calc(var(--spacing-base) * 1) calc(var(--spacing-base) * 2);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 200, 87, 0.3);
        }

        .coin-icon {
            width: 20px;
            height: 20px;
            animation: spin 3s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        .balance-text {
            font-size: 14px;
            font-weight: 600;
            color: var(--gcoin-gold);
        }

        .main-content {
            flex: 1;
            width: 100%;
            padding: calc(var(--spacing-base) * 3) calc(var(--spacing-base) * 2);
            padding-bottom: calc(var(--spacing-base) * 15);
            overflow-y: auto;
            position: relative;
        }

        .screen {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .feed-container {
            display: flex;
            flex-direction: column;
            gap: calc(var(--spacing-base) * 2);
        }

        .post-card {
            background: var(--bg-panel);
            border-radius: var(--radius-md);
            padding: calc(var(--spacing-base) * 2);
            border: 1px solid rgba(255, 255, 255, 0.06);
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.18);
            transition: all 0.3s ease;
        }

        .post-card:hover {
            border-color: rgba(91, 46, 138, 0.4);
            transform: translateY(-2px);
        }

        .post-header {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-base) * 1.5);
            margin-bottom: calc(var(--spacing-base) * 2);
            cursor: pointer;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--deep-purple), var(--electric-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            overflow: hidden;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .post-meta {
            flex: 1;
        }

        .poster-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--white);
            margin-bottom: 2px;
        }

        .post-time {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .post-content {
            font-size: 14px;
            line-height: 1.5;
            color: var(--white);
            margin-bottom: calc(var(--spacing-base) * 2);
            word-break: break-word;
        }

        .post-media {
            width: 100%;
            border-radius: var(--radius-sm);
            margin-bottom: calc(var(--spacing-base) * 2);
            overflow: hidden;
            max-height: 400px;
        }

        .post-media img {
            width: 100%;
            height: auto;
            display: block;
            border-radius: var(--radius-sm);
        }

        .post-media video {
            width: 100%;
            height: auto;
            display: block;
            border-radius: var(--radius-sm);
        }

        .earnings-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 200, 87, 0.1);
            padding: calc(var(--spacing-base) * 1) calc(var(--spacing-base) * 1.5);
            border-radius: var(--radius-xs);
            margin-bottom: calc(var(--spacing-base) * 2);
        }

        .earnings-label {
            font-size: 12px;
            color: var(--gcoin-gold);
            font-weight: 600;
        }

        .post-actions {
            display: flex;
            gap: calc(var(--spacing-base) * 2);
        }

        .action-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: calc(var(--spacing-base) * 1);
            padding: calc(var(--spacing-base) * 1.5);
            background: rgba(255, 255, 255, 0.05);
            border: none;
            border-radius: var(--radius-sm);
            color: var(--white);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.12s ease;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .action-btn.liked {
            background: rgba(227, 61, 122, 0.2);
            color: var(--vivid-magenta);
        }

        .action-icon {
            width: 16px;
            height: 16px;
        }

        .comments-section {
            margin-top: calc(var(--spacing-base) * 2);
            padding-top: calc(var(--spacing-base) * 2);
            border-top: 1px solid rgba(255, 255, 255, 0.06);
            display: none;
        }

        .comments-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .comments-container {
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: calc(var(--spacing-base) * 1.5);
        }

        .comment-item {
            display: flex;
            align-items: flex-start;
            gap: calc(var(--spacing-base) * 1);
            padding: calc(var(--spacing-base) * 1);
            margin-bottom: calc(var(--spacing-base) * 1);
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-sm);
        }

        .comment-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--deep-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .comment-content {
            flex: 1;
        }

        .comment-author {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .comment-text {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .comment-input-container {
            display: flex;
            gap: calc(var(--spacing-base) * 1);
        }

        .comment-input {
            flex: 1;
            padding: calc(var(--spacing-base) * 1) calc(var(--spacing-base) * 1.5);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-sm);
            color: var(--white);
            font-size: 12px;
            font-family: inherit;
        }

        .comment-input:focus {
            outline: none;
            border-color: var(--electric-blue);
        }

        .send-comment-btn {
            padding: calc(var(--spacing-base) * 1) calc(var(--spacing-base) * 2);
            background: var(--electric-blue);
            border: none;
            border-radius: var(--radius-sm);
            color: white;
            font-weight: 600;
            cursor: pointer;
        }

        .task-board-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: calc(var(--spacing-base) * 2);
            padding: calc(var(--spacing-base) * 2);
            background: var(--bg-panel);
            border-radius: var(--radius-md);
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .task-counter {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-base) * 1);
            font-size: 14px;
        }

        .counter-label {
            color: var(--text-secondary);
        }

        .counter-value {
            font-weight: 700;
            color: var(--electric-blue);
        }

        .new-task-btn {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-base) * 1);
            padding: calc(var(--spacing-base) * 1) calc(var(--spacing-base) * 2);
            background: linear-gradient(135deg, var(--deep-purple), var(--vivid-magenta));
            border: none;
            border-radius: var(--radius-sm);
            color: var(--white);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.12s ease;
        }

        .new-task-btn:hover {
            transform: scale(1.05);
        }

        .platform-grid-container {
            position: relative;
            margin-bottom: calc(var(--spacing-base) * 3);
        }

        .platform-grid {
            display: flex;
            gap: calc(var(--spacing-base) * 2);
            padding: calc(var(--spacing-base) * 1);
            overflow-x: auto;
            scroll-behavior: smooth;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .platform-grid::-webkit-scrollbar {
            display: none;
        }

        .platform-card {
            min-width: 100px;
            background: var(--bg-panel);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: var(--radius-md);
            padding: calc(var(--spacing-base) * 2);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .platform-card:hover {
            transform: translateY(-4px);
            border-color: var(--electric-blue);
            box-shadow: 0 8px 32px rgba(74, 163, 255, 0.2);
        }

        .platform-card.active {
            border-color: var(--vivid-magenta);
            background: rgba(227, 61, 122, 0.1);
        }

        .platform-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto calc(var(--spacing-base) * 1);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            padding: calc(var(--spacing-base) * 1);
        }

        .platform-icon svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
            transition: transform 0.3s ease;
        }

        .platform-card:hover .platform-icon svg {
            transform: scale(1.1) rotate(5deg);
        }

        .platform-name {
            font-size: 12px;
            font-weight: 600;
            color: var(--white);
            margin-bottom: calc(var(--spacing-base) * 0.5);
        }

        .platform-count {
            font-size: 10px;
            color: var(--text-secondary);
        }

        .task-list {
            display: flex;
            flex-direction: column;
            gap: calc(var(--spacing-base) * 2);
        }

        .task-card {
            background: var(--bg-panel);
            border-radius: var(--radius-md);
            padding: calc(var(--spacing-base) * 2);
            border: 1px solid rgba(255, 255, 255, 0.06);
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.18);
            position: relative;
        }

        .task-card.completed {
            opacity: 0.7;
            border-color: rgba(46, 204, 113, 0.3);
        }

        .task-card.completed::before {
            content: 'COMPLETED';
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            padding: 4px 8px;
            border-radius: var(--radius-xs);
            font-size: 10px;
            font-weight: 600;
        }

        .task-header {
            display: flex;
            align-items: start;
            justify-content: space-between;
            margin-bottom: calc(var(--spacing-base) * 2);
        }

        .task-info {
            flex: 1;
        }

        .task-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: calc(var(--spacing-base) * 1);
            color: var(--white);
        }

        .task-description {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
            margin-bottom: calc(var(--spacing-base) * 1);
        }

        .task-reward {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-base) * 0.5);
            padding: calc(var(--spacing-base) * 1) calc(var(--spacing-base) * 1.5);
            background: rgba(255, 200, 87, 0.15);
            border-radius: var(--radius-lg);
            font-size: 14px;
            font-weight: 700;
            color: var(--gcoin-gold);
        }

        .task-footer {
            display: flex;
            gap: calc(var(--spacing-base) * 1.5);
        }

        .task-btn {
            flex: 1;
            padding: calc(var(--spacing-base) * 1.5);
            border: none;
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.12s ease;
        }

        .task-btn.primary {
            background: linear-gradient(135deg, var(--deep-purple), var(--vivid-magenta));
            color: var(--white);
        }

        .task-btn.primary:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(91, 46, 138, 0.4);
        }

        .task-btn.secondary {
            background: rgba(255, 255, 255, 0.05);
            color: var(--white);
        }

        .task-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .watch-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: calc(var(--spacing-base) * 2);
            padding: calc(var(--spacing-base) * 2);
            background: var(--bg-panel);
            border-radius: var(--radius-md);
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .daily-limit {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-base) * 1);
            font-size: 14px;
            color: var(--text-secondary);
        }

        .cleanup-btn {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-base) * 0.75);
            padding: calc(var(--spacing-base) * 1) calc(var(--spacing-base) * 1.5);
            background: rgba(227, 61, 122, 0.15);
            border: 1px solid rgba(227, 61, 122, 0.3);
            border-radius: var(--radius-sm);
            color: var(--vivid-magenta);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.12s ease;
        }

        .cleanup-btn:hover {
            background: rgba(227, 61, 122, 0.25);
            transform: scale(1.05);
        }

        .watch-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: calc(var(--spacing-base) * 2);
        }

        .video-card {
            background: var(--bg-panel);
            border-radius: var(--radius-md);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.06);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .video-card:hover {
            transform: translateY(-4px);
            border-color: rgba(74, 163, 255, 0.4);
        }

        .video-card.watched {
            opacity: 0.6;
            pointer-events: none;
        }

        .video-thumbnail {
            width: 100%;
            height: 120px;
            background: linear-gradient(135deg, rgba(91, 46, 138, 0.3), rgba(74, 163, 255, 0.3));
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .play-icon {
            width: 48px;
            height: 48px;
            opacity: 0.9;
        }

        .video-duration {
            position: absolute;
            bottom: calc(var(--spacing-base) * 1);
            right: calc(var(--spacing-base) * 1);
            background: rgba(0, 0, 0, 0.8);
            padding: calc(var(--spacing-base) * 0.5) calc(var(--spacing-base) * 1);
            border-radius: var(--radius-xs);
            font-size: 12px;
            font-weight: 600;
        }

        .video-info {
            padding: calc(var(--spacing-base) * 2);
        }

        .video-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: calc(var(--spacing-base) * 1);
            line-height: 1.3;
        }

        .video-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .video-reward {
            color: var(--gcoin-gold);
            font-weight: 600;
        }

        .collected-badge {
            color: var(--electric-blue);
            font-weight: 600;
        }

        .profile-section {
            display: flex;
            flex-direction: column;
            gap: calc(var(--spacing-base) * 3);
        }

        .profile-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: calc(var(--spacing-base) * 2);
            padding: calc(var(--spacing-base) * 3);
            background: var(--bg-panel);
            border-radius: var(--radius-md);
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--deep-purple), var(--vivid-magenta));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 700;
            border: 3px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-name {
            font-size: 20px;
            font-weight: 700;
            text-align: center;
        }

        .profile-username {
            font-size: 14px;
            color: var(--text-secondary);
            text-align: center;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-base) * 2);
            width: 100%;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: calc(var(--spacing-base) * 0.5);
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--electric-blue);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .profile-menu {
            display: flex;
            flex-direction: column;
            gap: 0;
            background: var(--bg-panel);
            border-radius: var(--radius-md);
            border: 1px solid rgba(255, 255, 255, 0.06);
            overflow: hidden;
        }

        .menu-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: calc(var(--spacing-base) * 2) calc(var(--spacing-base) * 2.5);
            background: transparent;
            border: none;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
            color: var(--white);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.12s ease;
        }

        .menu-item:last-child {
            border-bottom: none;
        }

        .menu-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .menu-icon {
            width: 20px;
            height: 20px;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100%;
            background: var(--bg-panel);
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            justify-content: space-around;
            padding: calc(var(--spacing-base) * 1.5) 0;
            z-index: 100;
            backdrop-filter: blur(12px);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: calc(var(--spacing-base) * 0.5);
            padding: calc(var(--spacing-base) * 1) calc(var(--spacing-base) * 2);
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.12s ease;
            text-decoration: none;
        }

        .nav-item:hover {
            color: var(--white);
        }

        .nav-item.active {
            color: var(--electric-blue);
        }

        .nav-item.active .nav-icon {
            transform: scale(1.1);
        }

        .nav-icon {
            width: 24px;
            height: 24px;
            transition: transform 0.12s ease;
        }

        .fab {
            position: fixed;
            bottom: calc(var(--spacing-base) * 12);
            right: calc(var(--spacing-base) * 2);
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, var(--vivid-magenta), var(--soft-pink));
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 16px rgba(227, 61, 122, 0.4);
            transition: all 0.3s ease;
            z-index: 99;
            opacity: 1;
            transform: translateY(0);
        }

        .fab.hidden {
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 24px rgba(227, 61, 122, 0.6);
        }

        .fab-icon {
            width: 24px;
            height: 24px;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 200;
            animation: fadeIn 0.3s ease;
        }

        .modal-overlay.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: calc(var(--spacing-base) * 2);
        }

        .modal-content {
            width: 100%;
            max-width: 500px;
            background: var(--bg-panel);
            border-radius: var(--radius-md);
            padding: calc(var(--spacing-base) * 3);
            border: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
            animation: slideUp 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: calc(var(--spacing-base) * 3);
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
        }

        .close-btn {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.12s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1);
        }

        .close-icon {
            width: 16px;
            height: 16px;
        }

        .composer-form {
            display: flex;
            flex-direction: column;
            gap: calc(var(--spacing-base) * 2);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: calc(var(--spacing-base) * 1);
        }

        .form-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-input,
        .form-textarea {
            width: 100%;
            padding: calc(var(--spacing-base) * 1.5);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-sm);
            color: var(--white);
            font-size: 14px;
            font-family: inherit;
            transition: all 0.12s ease;
        }

        .form-input:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--electric-blue);
            background: rgba(255, 255, 255, 0.08);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .media-attach-area {
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-sm);
            padding: calc(var(--spacing-base) * 3);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .media-attach-area:hover {
            border-color: var(--electric-blue);
            background: rgba(74, 163, 255, 0.05);
        }

        .media-attach-area.drag-over {
            border-color: var(--vivid-magenta);
            background: rgba(227, 61, 122, 0.05);
        }

        .attach-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto calc(var(--spacing-base) * 2);
            color: var(--text-secondary);
        }

        .media-preview {
            display: flex;
            flex-wrap: wrap;
            gap: calc(var(--spacing-base) * 1);
            margin-top: calc(var(--spacing-base) * 2);
        }

        .preview-item {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: var(--radius-sm);
            overflow: hidden;
        }

        .preview-item img,
        .preview-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .remove-preview {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 24px;
            height: 24px;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .submit-btn {
            padding: calc(var(--spacing-base) * 2);
            background: linear-gradient(135deg, var(--deep-purple), var(--vivid-magenta));
            border: none;
            border-radius: var(--radius-sm);
            color: var(--white);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.12s ease;
        }

        .submit-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 16px rgba(91, 46, 138, 0.4);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .browser-frame {
            width: 100%;
            height: 80vh;
            background: var(--bg-panel);
            border-radius: var(--radius-md);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .browser-header {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-base) * 1);
            padding: calc(var(--spacing-base) * 1.5);
            background: rgba(255, 255, 255, 0.03);
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        }

        .browser-dots {
            display: flex;
            gap: calc(var(--spacing-base) * 0.75);
        }

        .browser-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--text-secondary);
        }

        .browser-url {
            flex: 1;
            padding: calc(var(--spacing-base) * 0.75) calc(var(--spacing-base) * 1.5);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-xs);
            font-size: 12px;
            color: var(--text-secondary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .browser-content {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .browser-content iframe {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }

        .timer-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(11, 11, 13, 0.95);
            padding: calc(var(--spacing-base) * 2);
            z-index: 10;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            gap: calc(var(--spacing-base) * 1.5);
        }

        .timer-display {
            font-size: 24px;
            font-weight: 700;
            color: var(--electric-blue);
            text-align: center;
        }

        .timer-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-align: center;
        }

        .timer-progress {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        .timer-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--deep-purple), var(--vivid-magenta));
            width: 0%;
            transition: width 1s linear;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-dark);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 1;
            transition: opacity 0.3s ease;
        }

        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--electric-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: calc(var(--spacing-base) * 2);
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-panel);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            padding: calc(var(--spacing-base) * 2);
            min-width: 300px;
            max-width: 400px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .toast.success {
            border-left: 4px solid #2ecc71;
        }

        .toast.error {
            border-left: 4px solid #e74c3c;
        }

        .toast.warning {
            border-left: 4px solid #f39c12;
        }

        .toast.info {
            border-left: 4px solid var(--electric-blue);
        }

        .toast-content {
            display: flex;
            align-items: flex-start;
            gap: calc(var(--spacing-base) * 1.5);
        }

        .toast-icon {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .toast-message {
            flex: 1;
            font-size: 14px;
            line-height: 1.4;
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 4px;
        }

        .vip-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            border-radius: var(--radius-xs);
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .vip-badge.none {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }

        .vip-badge.basic {
            background: rgba(139, 92, 246, 0.2);
            color: #8b5cf6;
        }

        .vip-badge.silver {
            background: rgba(156, 163, 175, 0.2);
            color: #9ca3af;
        }

        .vip-badge.gold {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .vip-badge.premium {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        @media (min-width: 768px) {
            .app-container {
                max-width: 430px;
                margin: 0 auto;
                box-shadow: 0 0 40px rgba(0, 0, 0, 0.3);
            }

            .watch-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @keyframes scrollPlatforms {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .platform-grid.auto-scroll {
            animation: scrollPlatforms 30s linear infinite;
        }

        .platform-grid-container:hover .platform-grid.auto-scroll {
            animation-play-state: paused;
        }

        .platform-card.youtube { border-color: rgba(255, 0, 0, 0.3); }
        .platform-card.youtube:hover { border-color: #FF0000; }
        
        .platform-card.telegram { border-color: rgba(0, 136, 204, 0.3); }
        .platform-card.telegram:hover { border-color: #0088cc; }
        
        .platform-card.instagram { border-color: rgba(225, 48, 108, 0.3); }
        .platform-card.instagram:hover { border-color: #E1306C; }
        
        .platform-card.twitter { border-color: rgba(29, 161, 242, 0.3); }
        .platform-card.twitter:hover { border-color: #1DA1F2; }
        
        .platform-card.tiktok { border-color: rgba(0, 0, 0, 0.3); }
        .platform-card.tiktok:hover { border-color: #000000; }
        
        .platform-card.whatsapp { border-color: rgba(37, 211, 102, 0.3); }
        .platform-card.whatsapp:hover { border-color: #25D366; }
        
        .platform-card.discord { border-color: rgba(88, 101, 242, 0.3); }
        .platform-card.discord:hover { border-color: #5865F2; }
        
        .platform-card.facebook { border-color: rgba(24, 119, 242, 0.3); }
        .platform-card.facebook:hover { border-color: #1877F2; }
        
        .platform-card.website { border-color: rgba(74, 163, 255, 0.3); }
        .platform-card.website:hover { border-color: #4AA3FF; }
        
        .transaction-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        }
        
        .transaction-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
            font-size: 18px;
        }
        
        .transaction-icon.earn {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }
        
        .transaction-icon.spend {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }
        
        .transaction-details {
            flex: 1;
        }
        
        .transaction-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .transaction-time {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .transaction-amount {
            font-weight: 700;
            font-size: 16px;
        }
        
        .transaction-amount.earn {
            color: #2ecc71;
        }
        
        .transaction-amount.spend {
            color: #e74c3c;
        }
    </style>
    
    <!-- Monetag Ad SDK -->
    <script>
        (function(m,o,n,e,t,a,g){
            m['MonetagObject']=t;m[t]=m[t]||function(){
                (m[t].q=m[t].q||[]).push(arguments)
            };
            a=o.createElement(n);g=o.getElementsByTagName(n)[0];
            a.async=1;a.src=e;g.parentNode.insertBefore(a,g)
        })(window,document,'script','https://cdn.monetag.com/tag.min.js','monetag');
        monetag('start');
    </script>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading GainGrid...</div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <!-- Main App -->
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="logo-section">
                <div class="logo-icon">
                    <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="32" height="32" rx="8" fill="url(#logo-gradient)" />
                        <path d="M10 16L14 20L22 12" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                        <defs>
                            <linearGradient id="logo-gradient" x1="0" y1="0" x2="32" y2="32">
                                <stop stop-color="#5B2E8A" />
                                <stop offset="1" stop-color="#E33D7A" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <h1 class="app-title" id="appTitle">GainGrid</h1>
            </div>
            <div class="balance-chip">
                <div class="coin-icon">
                    <svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="10" cy="10" r="9" fill="#FFC857" stroke="#FFD87A" stroke-width="1" />
                        <text x="10" y="14" text-anchor="middle" fill="#0B0B0D" font-size="12" font-weight="700">G</text>
                    </svg>
                </div>
                <span class="balance-text" id="balanceText">0</span>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <!-- GridHome Screen -->
            <section class="screen active" id="gridhomeScreen">
                <div class="feed-container" id="feedContainer">
                    <!-- Posts loaded from localStorage -->
                </div>
            </section>

            <!-- Task Board Screen -->
            <section class="screen" id="tasksScreen">
                <div class="task-board-header">
                    <div class="task-counter">
                        <span class="counter-label">Tasks today:</span>
                        <span class="counter-value" id="taskCounter">0/20</span>
                    </div>
                    <button class="new-task-btn" id="newTaskBtn">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 3V13M3 8H13" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <span>New Task</span>
                    </button>
                </div>

                <!-- Platform Grid -->
                <div class="platform-grid-container">
                    <div class="platform-grid auto-scroll" id="platformGrid">
                        <!-- Platforms loaded dynamically -->
                    </div>
                </div>

                <!-- Task List -->
                <div class="task-list" id="taskList">
                    <!-- Tasks from bot payload + random tasks -->
                </div>
            </section>

            <!-- Watch & Earn Screen -->
            <section class="screen" id="watchScreen">
                <div class="watch-header">
                    <div class="daily-limit">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" />
                            <path d="M10 5V10L13 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <span>Daily Ads: <strong id="adsCounter">0/20</strong></span>
                    </div>
                    <button class="cleanup-btn" id="cleanupBtn">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M2 4H14M6 7V11M10 7V11M3 4L4 13C4 13.5 4.5 14 5 14H11C11.5 14 12 13.5 12 13L13 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                        </svg>
                        <span>Clean Up</span>
                    </button>
                </div>

                <div class="watch-grid" id="watchGrid">
                    <!-- Ads loaded dynamically -->
                </div>
            </section>

            <!-- Profile Screen -->
            <section class="screen" id="profileScreen">
                <div class="profile-section">
                    <div class="profile-header">
                        <div class="profile-avatar" id="profileAvatar">
                            <!-- Avatar loaded dynamically -->
                        </div>
                        <h2 class="profile-name" id="profileName">Loading...</h2>
                        <p class="profile-username" id="profileUsername">@username</p>
                        <div class="vip-badge" id="vipBadge">VIP Level</div>
                    </div>

                    <div class="profile-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="statGcoins">0</div>
                            <div class="stat-label">G-Coins</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="statTotalEarned">0</div>
                            <div class="stat-label">Total Earned</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="statTasksDone">0</div>
                            <div class="stat-label">Tasks Done</div>
                        </div>
                    </div>

                    <div class="profile-menu">
                        <button class="menu-item" id="editProfileBtn">
                            <span>Edit Profile</span>
                            <svg class="menu-icon" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 16L14 10L8 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </button>
                        <button class="menu-item" id="transactionHistoryBtn">
                            <span>Transaction History</span>
                            <svg class="menu-icon" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 16L14 10L8 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </button>
                        <button class="menu-item" id="referralsBtn">
                            <span>Referrals</span>
                            <svg class="menu-icon" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 16L14 10L8 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </button>
                        <button class="menu-item" id="settingsBtn">
                            <span>Settings</span>
                            <svg class="menu-icon" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 16L14 10L8 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </button>
                        <button class="menu-item" id="helpSupportBtn">
                            <span>Help & Support</span>
                            <svg class="menu-icon" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 16L14 10L8 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" onclick="switchScreen('gridhome')">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M9 22V12H15V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <span>GridHome</span>
            </button>
            <button class="nav-item" onclick="switchScreen('tasks')">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 11L12 14L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M21 12V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <span>Tasks</span>
            </button>
            <button class="nav-item" onclick="switchScreen('watch')">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5 3L19 12L5 21V3Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <span>Watch</span>
            </button>
            <button class="nav-item" onclick="switchScreen('profile')">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <span>Profile</span>
            </button>
        </nav>

        <!-- Floating Action Button (Post) -->
        <button class="fab" id="fabPost" onclick="openComposer()">
            <svg class="fab-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 20H21" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M16.5 3.49998C16.8978 3.10216 17.4374 2.87866 18 2.87866C18.2786 2.87866 18.5544 2.93353 18.8118 3.04014C19.0692 3.14674 19.303 3.303 19.5 3.49998C19.697 3.69697 19.8532 3.93082 19.9598 4.18819C20.0665 4.44556 20.1213 4.72141 20.1213 4.99998C20.1213 5.27856 20.0665 5.55441 19.9598 5.81178C19.8532 6.06915 19.697 6.303 19.5 6.49998L7 19L3 20L4 16L16.5 3.49998Z" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
        </button>

        <!-- Modals -->
        <!-- Composer Modal -->
        <div class="modal-overlay" id="composerModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Create Post</h2>
                    <button class="close-btn" onclick="closeComposer()">
                        <svg class="close-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                    </button>
                </div>
                <form class="composer-form" id="postForm" onsubmit="submitPost(event)">
                    <div class="form-group">
                        <label class="form-label" for="postContent">Post Content</label>
                        <textarea class="form-textarea" id="postContent" placeholder="What do you want to share? Use # for hashtags and @ for mentions" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="postLink">Link URL (Optional)</label>
                        <input type="url" class="form-input" id="postLink" placeholder="https://example.com">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="postLinkType">Link Type (If URL provided)</label>
                        <select class="form-input" id="postLinkType">
                            <option value="visit">Visit Website</option>
                            <option value="join">Join Group/Channel</option>
                            <option value="watch">Watch Video</option>
                            <option value="install">Install App</option>
                            <option value="signup">Sign Up</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="postReward">Reward Amount (G-Coins)</label>
                        <input type="number" class="form-input" id="postReward" placeholder="Enter reward amount" min="10000" max="100000" required>
                        <div class="reward-preview">
                            <div class="preview-label">Minimum: 10,000 G-Coins</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Media (Optional - Images or Videos)</label>
                        <div class="media-attach-area" id="mediaDropArea">
                            <svg class="attach-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="2" y="2" width="16" height="16" rx="2" stroke="currentColor" stroke-width="1.5" />
                                <circle cx="7" cy="7" r="2" stroke="currentColor" stroke-width="1.5" />
                                <path d="M2 14L7 9L12 14M10 12L13 9L18 14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                            </svg>
                            <div class="file-drop-text">Drag & drop photos/videos or click to upload</div>
                            <div class="file-drop-hint">Max size: 10MB per file</div>
                            <input type="file" id="mediaInput" accept="image/*,video/*" multiple style="display: none;">
                        </div>
                        <div class="media-preview" id="mediaPreview"></div>
                    </div>
                    
                    <button type="submit" class="submit-btn" id="postSubmitBtn">Publish Post</button>
                </form>
            </div>
        </div>

        <!-- Browser Modal -->
        <div class="modal-overlay" id="browserModal">
            <div class="browser-frame">
                <div class="browser-header">
                    <div class="browser-dots">
                        <div class="browser-dot"></div>
                        <div class="browser-dot"></div>
                        <div class="browser-dot"></div>
                    </div>
                    <div class="browser-url" id="browserUrl">https://gaingrid.com</div>
                    <button class="close-btn" onclick="closeBrowserModal()">
                        <svg class="close-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                    </button>
                </div>
                <div class="browser-content">
                    <iframe class="browser-iframe" id="browserIframe" sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-modals allow-downloads"></iframe>
                    <div class="timer-overlay" id="timerOverlay">
                        <div class="timer-display" id="timerDisplay">00:00</div>
                        <div class="timer-label" id="timerLabel">Please wait while we verify completion</div>
                        <div class="timer-progress">
                            <div class="timer-progress-bar" id="timerProgressBar"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Section Modal -->
        <div class="modal-overlay" id="profileSectionModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="profileSectionTitle">Profile Section</h2>
                    <button class="close-btn" onclick="closeProfileSection()">
                        <svg class="close-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                    </button>
                </div>
                <div class="modal-body" id="profileSectionContent">
                    <!-- Content loaded dynamically -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== GLOBAL STATE ====================
        const appState = {
            user: null,
            balance: 0,
            vipLevel: 'none',
            referrals: 0,
            dailyCounters: {
                tasks: 0,
                ads: 0
            },
            posts: [],
            tasks: [],
            ads: [],
            randomTasks: [],
            platforms: [],
            currentTask: null,
            currentAd: null,
            currentPostId: null,
            timerInterval: null,
            isTelegramWebApp: false,
            WebApp: null,
            lastScrollPosition: 0,
            telegramUserId: null,
            botCallbackUrl: null,
            botPayload: null,
            sessionId: Date.now().toString(),
            isDirectTaskOpen: false,
            directTaskData: null
        };

        // ==================== CONSTANTS ====================
        const SMART_LINKS = [
            'https://otieu.com/4/10176113',
            'https://otieu.com/4/10176184',
            'https://otieu.com/4/10176114',
            'https://otieu.com/4/10176185'
        ];

        const PLATFORMS = [
            { id: 'youtube', name: 'YouTube', color: '#FF0000' },
            { id: 'telegram', name: 'Telegram', color: '#0088CC' },
            { id: 'instagram', name: 'Instagram', color: '#E1306C' },
            { id: 'twitter', name: 'Twitter', color: '#1DA1F2' },
            { id: 'tiktok', name: 'TikTok', color: '#000000' },
            { id: 'facebook', name: 'Facebook', color: '#1877F2' },
            { id: 'whatsapp', name: 'WhatsApp', color: '#25D366' },
            { id: 'discord', name: 'Discord', color: '#5865F2' },
            { id: 'website', name: 'Website', color: '#4AA3FF' }
        ];

        // ==================== TELEGRAM INTEGRATION ====================
        function initializeTelegram() {
            if (window.Telegram && window.Telegram.WebApp) {
                try {
                    appState.WebApp = window.Telegram.WebApp;
                    appState.isTelegramWebApp = true;
                    
                    // Initialize Telegram Web App
                    appState.WebApp.ready();
                    appState.WebApp.expand();
                    
                    // Get Telegram user data
                    const tgUser = appState.WebApp.initDataUnsafe.user;
                    if (tgUser) {
                        appState.user = {
                            id: tgUser.id,
                            firstName: tgUser.first_name,
                            lastName: tgUser.last_name || '',
                            username: tgUser.username || '',
                            photoUrl: tgUser.photo_url || null,
                            languageCode: tgUser.language_code || 'en'
                        };
                        appState.telegramUserId = tgUser.id;
                    }
                    
                    return true;
                } catch (error) {
                    console.error('Telegram initialization error:', error);
                    return false;
                }
            }
            return false;
        }

        // ==================== BASE64 PAYLOAD HANDLING ====================
        function safeBase64Decode(encodedString) {
            try {
                // Replace URL-safe characters
                let safeString = encodedString.replace(/-/g, '+').replace(/_/g, '/');
                
                // Add padding if needed
                const pad = safeString.length % 4;
                if (pad) {
                    safeString += '==='.slice(0, 4 - pad);
                }
                
                // Decode
                const decoded = atob(safeString);
                
                // Try to parse as JSON
                try {
                    return JSON.parse(decoded);
                } catch (e) {
                    // If not JSON, try URI decode then JSON
                    const uriDecoded = decodeURIComponent(decoded);
                    return JSON.parse(uriDecoded);
                }
            } catch (error) {
                console.error('Base64 decode error:', error);
                return null;
            }
        }

        function parseBotPayload() {
            try {
                // Check URL parameters for start param
                const urlParams = new URLSearchParams(window.location.search);
                const startParam = urlParams.get('start');
                
                if (!startParam) {
                    // Check hash parameters
                    const hash = window.location.hash.substring(1);
                    if (hash.includes('start=')) {
                        const hashParams = new URLSearchParams(hash);
                        const hashStart = hashParams.get('start');
                        if (hashStart) {
                            return safeBase64Decode(hashStart);
                        }
                    }
                    return null;
                }
                
                // Decode the payload
                const payload = safeBase64Decode(startParam);
                
                if (payload && payload.type === 'gaingrid_dashboard') {
                    appState.botPayload = payload;
                    return payload;
                }
                
                return null;
            } catch (error) {
                console.error('Payload parse error:', error);
                return null;
            }
        }

        function applyBotPayload(payload) {
            if (!payload) return;
            
            console.log('Applying bot payload:', payload);
            
            // Set user ID from bot
            appState.telegramUserId = payload.user_id;
            
            // Set balance from bot (CORRECT - NOT from localStorage)
            if (payload.gcoin !== undefined) {
                appState.balance = Number(payload.gcoin);
                console.log('Setting balance from bot:', appState.balance);
            }
            
            // Set VIP level from bot (CORRECT mapping)
            if (payload.vip_level) {
                let vip = payload.vip_level.toString().toLowerCase();
                console.log('Raw VIP from bot:', vip);
                
                // Map VIP levels correctly
                if (vip.includes('premium') || vip.includes('plat') || vip.includes('')) {
                    appState.vipLevel = 'premium';
                } else if (vip.includes('gold')) {
                    appState.vipLevel = 'gold';
                } else if (vip.includes('silver')) {
                    appState.vipLevel = 'silver';
                } else if (vip.includes('basic')) {
                    appState.vipLevel = 'basic';
                } else {
                    appState.vipLevel = 'none';
                }
                console.log('Mapped VIP level:', appState.vipLevel);
            }
            
            // Set referrals from bot
            if (payload.referrals !== undefined) {
                appState.referrals = Number(payload.referrals);
            }
            
            // Set callback URL from bot
            if (payload.callback_url) {
                appState.botCallbackUrl = payload.callback_url;
                console.log('Bot callback URL:', appState.botCallbackUrl);
            }
            
            // Update UI with bot data
            updateUIFromBotData();
        }

        // ==================== LOCALSTORAGE FOR VIRAL POSTS ====================
        const STORAGE_KEYS = {
            POSTS: 'gaingrid_posts',
            DAILY_COUNTERS: 'gaingrid_daily_counters',
            TOTAL_EARNED: 'gaingrid_total_earned'
        };

        function savePostsToStorage() {
            try {
                localStorage.setItem(STORAGE_KEYS.POSTS, JSON.stringify(appState.posts));
                return true;
            } catch (e) {
                console.error('Save posts error:', e);
                return false;
            }
        }

        function loadPostsFromStorage() {
            try {
                const savedPosts = localStorage.getItem(STORAGE_KEYS.POSTS);
                if (savedPosts) {
                    appState.posts = JSON.parse(savedPosts);
                    if (appState.posts.length > 0) {
                        updateFeed();
                        return true;
                    }
                }
            } catch (e) {
                console.error('Load posts error:', e);
            }
            return false;
        }

        // ==================== WEBHOOK/BOT COMMUNICATION ====================
        async function sendToBotWebhook(action, data) {
            if (!appState.botCallbackUrl) {
                console.warn('No callback URL available');
                return { success: false, error: 'No callback URL' };
            }
            
            try {
                const payload = {
                    action: action,
                    data: data,
                    user_id: appState.telegramUserId,
                    timestamp: new Date().toISOString(),
                    session_id: appState.sessionId,
                    source: 'gaingrid_webapp'
                };
                
                // Use fetch with no-cors for cross-origin
                const response = await fetch(appState.botCallbackUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload),
                    mode: 'no-cors'
                });
                
                return { success: true };
            } catch (error) {
                console.error('Webhook send error:', error);
                return { success: false, error: error.message };
            }
        }

        // ==================== UI UPDATE FUNCTIONS ====================
        function updateUIFromBotData() {
            // Update balance from bot payload
            document.getElementById('balanceText').textContent = appState.balance.toLocaleString();
            document.getElementById('statGcoins').textContent = appState.balance.toLocaleString();
            
            // Update VIP badge from bot payload
            updateVipBadge();
            
            // Update profile if Telegram user available
            if (appState.user) {
                updateProfileFromTelegram();
            }
            
            // Update counters
            updateCounters();
        }

        function updateVipBadge() {
            const vipBadge = document.getElementById('vipBadge');
            if (!vipBadge) return;
            
            // Clear all classes
            vipBadge.className = 'vip-badge';
            
            // Add current VIP level class
            vipBadge.classList.add(appState.vipLevel);
            
            // Set badge text
            const badgeText = {
                none: 'No VIP',
                basic: 'Basic VIP',
                silver: 'Silver VIP',
                gold: 'Gold VIP',
                premium: 'Premium VIP'
            }[appState.vipLevel] || 'No VIP';
            
            vipBadge.textContent = badgeText;
        }

        function updateProfileFromTelegram() {
            const profileName = document.getElementById('profileName');
            const profileUsername = document.getElementById('profileUsername');
            const profileAvatar = document.getElementById('profileAvatar');
            
            if (profileName && appState.user) {
                const fullName = `${appState.user.firstName || ''} ${appState.user.lastName || ''}`.trim();
                profileName.textContent = fullName || 'Telegram User';
            }
            
            if (profileUsername && appState.user) {
                const username = appState.user.username || '';
                profileUsername.textContent = username.startsWith('@') ? username : `@${username}`;
            }
            
            if (profileAvatar && appState.user) {
                if (appState.user.photoUrl) {
                    profileAvatar.innerHTML = `<img src="${appState.user.photoUrl}" alt="Profile" onerror="this.style.display='none'; this.parentElement.textContent='${getInitials(appState.user.firstName, appState.user.lastName)}'">`;
                } else {
                    const initials = getInitials(appState.user.firstName, appState.user.lastName);
                    profileAvatar.textContent = initials;
                }
            }
        }

        // ==================== IFRAME & BROWSER FIXES ====================
        function openBrowserModal(url, linkType = 'visit') {
            const modal = document.getElementById('browserModal');
            const iframe = document.getElementById('browserIframe');
            const browserUrl = document.getElementById('browserUrl');
            
            if (!modal || !iframe || !browserUrl) return;
            
            // Set URL
            browserUrl.textContent = url;
            
            // Configure iframe based on link type
            if (linkType === 'join' || linkType === 'install') {
                // For Telegram/App links, try to open directly
                if (appState.WebApp && (url.includes('t.me') || url.includes('telegram.me'))) {
                    appState.WebApp.openTelegramLink(url);
                    showToast('Opening in Telegram...', 'info');
                    return;
                } else if (url.includes('market://') || url.includes('itms-apps://')) {
                    // App store links
                    window.open(url, '_blank');
                    showToast('Opening app store...', 'info');
                    return;
                }
            }
            
            // Set enhanced sandbox permissions for iframe
            iframe.sandbox = 'allow-scripts allow-same-origin allow-forms allow-popups allow-modals allow-downloads';
            
            // Add error handling
            iframe.onload = function() {
                console.log('Iframe loaded successfully');
            };
            
            iframe.onerror = function() {
                console.error('Iframe loading error');
                showToast('Could not load content. Opening in new tab...', 'warning');
                
                // Fallback: Open in new tab
                setTimeout(() => {
                    window.open(url, '_blank');
                    closeBrowserModal();
                }, 1000);
            };
            
            // Load URL with timeout
            setTimeout(() => {
                try {
                    iframe.src = url;
                } catch (error) {
                    console.error('Iframe src set error:', error);
                    window.open(url, '_blank');
                    closeBrowserModal();
                }
            }, 100);
            
            // Show modal
            modal.classList.add('active');
        }

        function closeBrowserModal() {
            const modal = document.getElementById('browserModal');
            const iframe = document.getElementById('browserIframe');
            
            if (modal) modal.classList.remove('active');
            if (iframe) {
                iframe.src = 'about:blank';
            }
            
            if (appState.timerInterval) {
                clearInterval(appState.timerInterval);
                appState.timerInterval = null;
            }
            
            document.getElementById('timerDisplay').textContent = '00:00';
            document.getElementById('timerProgressBar').style.width = '0%';
            document.getElementById('timerOverlay').style.display = 'none';
        }

        // ==================== POST SYSTEM ====================
        function loadDefaultPosts() {
            appState.posts = [
                {
                    id: '1',
                    userId: '123456',
                    username: 'johndoe',
                    userAvatar: 'JD',
                    content: 'Check out this amazing opportunity to earn G-coins! Join our community and start earning today. Limited spots available!',
                    media: 'https://images.unsplash.com/photo-1611224923853-80b023f02d71?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                    link: 'https://example.com/join',
                    linkType: 'join',
                    reward: 5000,
                    likes: 24,
                    comments: [
                        { id: 'c1', userId: 'user1', username: 'Alice', text: 'Great opportunity!' },
                        { id: 'c2', userId: 'user2', username: 'Bob', text: 'Just completed!' }
                    ],
                    shares: 12,
                    views: 245,
                    timestamp: '2 hours ago',
                    userHasLiked: false,
                    isVideo: false
                },
                {
                    id: '2',
                    userId: '789012',
                    username: 'sarahkim',
                    userAvatar: 'SK',
                    content: 'New task alert! Complete this survey and earn instant rewards. Takes only 5 minutes!',
                    media: 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                    link: 'https://example.com/survey',
                    linkType: 'visit',
                    reward: 3000,
                    likes: 18,
                    comments: [
                        { id: 'c3', userId: 'user3', username: 'Charlie', text: 'Easy money!' }
                    ],
                    shares: 3,
                    views: 189,
                    timestamp: '5 hours ago',
                    userHasLiked: true,
                    isVideo: false
                },
                {
                    id: '3',
                    userId: 'video_creator',
                    username: 'Video Master',
                    userAvatar: 'VM',
                    content: ' Check out this tutorial video on how to maximize your earnings on GainGrid! Like and share for extra rewards.',
                    media: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',
                    link: null,
                    linkType: null,
                    reward: 8000,
                    likes: 45,
                    comments: [
                        { id: 'c4', userId: 'user4', username: 'David', text: 'Great video tutorial!' }
                    ],
                    shares: 12,
                    views: 312,
                    timestamp: '1 hour ago',
                    userHasLiked: false,
                    isVideo: true
                }
            ];
            savePostsToStorage();
            updateFeed();
        }

        function updateFeed() {
            const feedContainer = document.getElementById('feedContainer');
            if (!feedContainer) return;
            
            feedContainer.innerHTML = '';
            
            if (appState.posts.length === 0) {
                feedContainer.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        No posts yet. Be the first to create a post!
                    </div>
                `;
                return;
            }
            
            appState.posts.forEach(post => {
                const postElement = createPostElement(post);
                feedContainer.appendChild(postElement);
            });
        }

        function createPostElement(post) {
            const div = document.createElement('div');
            div.className = 'post-card';
            div.dataset.postId = post.id;
            
            // Media HTML
            let mediaHtml = '';
            if (post.media) {
                if (post.isVideo) {
                    mediaHtml = `
                        <div class="post-media">
                            <video controls>
                                <source src="${post.media}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                    `;
                } else {
                    mediaHtml = `
                        <div class="post-media">
                            <img src="${post.media}" alt="Post image" onerror="this.style.display='none'">
                        </div>
                    `;
                }
            }
            
            // Action button text
            const actionText = getActionText(post.linkType);
            const showActionButton = post.link && post.linkType;
            
            // Action button HTML
            const actionButtonHtml = showActionButton ? `
                <button class="action-btn" onclick="handlePostAction('${post.id}', '${post.link}', '${post.linkType}', ${post.reward})">
                    <svg class="action-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2L8 8L14 2ZM14 2L9.5 14L8 8L2 6.5L14 2Z" 
                              stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>${actionText}</span>
                </button>
            ` : '';
            
            div.innerHTML = `
                <div class="post-header" onclick="viewUserProfile('${post.userId}')">
                    <div class="avatar">
                        ${post.userAvatar}
                    </div>
                    <div class="post-meta">
                        <div class="poster-name">${post.username}</div>
                        <div class="post-time">${post.timestamp}</div>
                    </div>
                </div>
                <div class="post-content">${post.content}</div>
                ${mediaHtml}
                <div class="earnings-bar">
                    <span class="earnings-label">Earn up to ${post.reward.toLocaleString()} G-coins</span>
                </div>
                <div class="post-actions">
                    <button class="action-btn ${post.userHasLiked ? 'liked' : ''}" onclick="handleLike('${post.id}', this)">
                        <svg class="action-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 14L2.5 8.5C1.5 7.5 1.5 5.8 2.5 4.8C3.5 3.8 5.2 3.8 6.2 4.8L8 6.6L9.8 4.8C10.8 3.8 12.5 3.8 13.5 4.8C14.5 5.8 14.5 7.5 13.5 8.5L8 14Z" 
                                  stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                  ${post.userHasLiked ? 'fill="currentColor"' : 'fill="none"'}/>
                        </svg>
                        <span>${post.likes}</span>
                    </button>
                    ${actionButtonHtml}
                    <button class="action-btn" onclick="toggleComments('${post.id}')">
                        <svg class="action-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 11C14 11.5 13.5 12 13 12H4L2 14V3C2 2.5 2.5 2 3 2H13C13.5 2 14 2.5 14 3V11Z" 
                                  stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>${post.comments.length}</span>
                    </button>
                </div>
                <div class="comments-section" id="comments-${post.id}">
                    <div class="comments-container" id="comments-container-${post.id}">
                        ${post.comments.map(comment => `
                            <div class="comment-item">
                                <div class="comment-avatar">${comment.username.charAt(0)}</div>
                                <div class="comment-content">
                                    <div class="comment-author">${comment.username}</div>
                                    <div class="comment-text">${comment.text}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="comment-input-container">
                        <input type="text" class="comment-input" id="comment-input-${post.id}" placeholder="Write a comment...">
                        <button class="send-comment-btn" onclick="sendComment('${post.id}')">Send</button>
                    </div>
                </div>
            `;
            
            return div;
        }

        // ==================== TASKS & ADS ====================
        async function loadTasks() {
            // Default tasks
            appState.tasks = [
                {
                    id: 't1',
                    platform: 'youtube',
                    title: 'Watch YouTube Video',
                    description: 'Watch full video and like. Stay 02:30 for reward.',
                    duration: 150,
                    reward: 5000,
                    link: getRandomSmartLink(),
                    completed: false
                },
                {
                    id: 't2',
                    platform: 'telegram',
                    title: 'Join Telegram Channel',
                    description: 'Join channel and stay active. Stay 00:45 for reward.',
                    duration: 45,
                    reward: 3500,
                    link: getRandomSmartLink(),
                    completed: false
                },
                {
                    id: 't3',
                    platform: 'instagram',
                    title: 'Follow Instagram Account',
                    description: 'Follow account and like 3 posts.',
                    duration: 120,
                    reward: 4000,
                    link: getRandomSmartLink(),
                    completed: false
                }
            ];
            
            // Generate random tasks
            generateRandomTasks();
            
            // Update UI
            updateTasks();
        }

        function generateRandomTasks() {
            appState.randomTasks = [];
            const taskCount = Math.min(5, 20 - appState.tasks.length);
            
            for (let i = 0; i < taskCount; i++) {
                appState.randomTasks.push({
                    id: `random_${Date.now()}_${i}`,
                    platform: 'website',
                    title: getRandomTaskTitle(),
                    description: getRandomTaskDescription(),
                    duration: Math.floor(Math.random() * 120) + 60,
                    reward: Math.floor(Math.random() * 201) + 100,
                    link: getRandomSmartLink(),
                    completed: false,
                    isRandom: true
                });
            }
        }

        async function loadAds() {
            appState.ads = [];
            const adCount = 8;
            
            for (let i = 0; i < adCount; i++) {
                appState.ads.push({
                    id: `ad_${Date.now()}_${i}`,
                    title: getRandomAdTitle(),
                    duration: Math.floor(Math.random() * 30) + 30,
                    reward: Math.floor(Math.random() * 61) + 60,
                    source: getRandomAdSource(),
                    link: getRandomSmartLink(),
                    watched: false
                });
            }
            
            updateAds();
        }

        // ==================== INITIALIZATION ====================
        async function initializeApp() {
            try {
                console.log('Initializing GainGrid...');
                
                // Initialize Telegram FIRST
                initializeTelegram();
                
                // Parse bot payload SECOND
                const botPayload = parseBotPayload();
                if (botPayload) {
                    console.log('Bot payload found:', botPayload);
                    applyBotPayload(botPayload);
                } else {
                    console.log('No bot payload found');
                }
                
                // Load persistent posts
                if (!loadPostsFromStorage()) {
                    loadDefaultPosts();
                }
                
                // Load platforms
                loadPlatforms();
                
                // Load tasks and ads
                await loadTasks();
                await loadAds();
                
                // Setup event listeners
                setupEventListeners();
                
                // Initialize platform auto-scroll
                initPlatformAutoScroll();
                
                // Hide loading overlay PROPERLY
                setTimeout(() => {
                    const loadingOverlay = document.getElementById('loadingOverlay');
                    if (loadingOverlay) {
                        loadingOverlay.classList.add('hidden');
                    }
                }, 800);
                
            } catch (error) {
                console.error('Initialization error:', error);
                
                // Still hide loading
                setTimeout(() => {
                    const loadingOverlay = document.getElementById('loadingOverlay');
                    if (loadingOverlay) {
                        loadingOverlay.classList.add('hidden');
                    }
                }, 500);
            }
        }

        // ==================== UTILITY FUNCTIONS ====================
        function getRandomSmartLink() {
            return SMART_LINKS[Math.floor(Math.random() * SMART_LINKS.length)];
        }

        function getRandomAdTitle() {
            const titles = [
                'Tech Review 2024',
                'Crypto Market Update',
                'Gaming News Today',
                'Product Launch Event',
                'Mobile App Review'
            ];
            return titles[Math.floor(Math.random() * titles.length)];
        }

        function getRandomAdSource() {
            const sources = [
                'TechBrand Co.',
                'CryptoExchange',
                'GameStore',
                'Fashion Brand',
                'Finance Corp'
            ];
            return sources[Math.floor(Math.random() * sources.length)];
        }

        function getRandomTaskTitle() {
            const titles = [
                'Website Visit Task',
                'Survey Completion',
                'App Installation',
                'Product Review',
                'Market Research'
            ];
            return titles[Math.floor(Math.random() * titles.length)];
        }

        function getRandomTaskDescription() {
            const descriptions = [
                'Visit website and stay for specified time',
                'Complete short survey for research',
                'Install app and open for verification',
                'Review product features',
                'Participate in market research'
            ];
            return descriptions[Math.floor(Math.random() * descriptions.length)];
        }

        function getActionText(type) {
            const actions = {
                visit: 'Visit',
                join: 'Join',
                watch: 'Watch',
                install: 'Install',
                signup: 'Sign Up'
            };
            return actions[type] || 'Open';
        }

        function getInitials(firstName, lastName) {
            return ((firstName?.[0] || '') + (lastName?.[0] || '')).toUpperCase() || 'U';
        }

        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icons = {
                success: '',
                error: '',
                warning: '',
                info: ''
            };
            
            toast.innerHTML = `
                <div class="toast-content">
                    <div class="toast-icon">${icons[type] || ''}</div>
                    <div class="toast-message">${message}</div>
                    <button class="toast-close" onclick="this.parentElement.parentElement.remove()"></button>
                </div>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 5000);
        }

        // ==================== EXPORT FUNCTIONS ====================
        window.switchScreen = switchScreen;
        window.openComposer = openComposer;
        window.closeComposer = closeComposer;
        window.handleLike = handleLike;
        window.handleTaskAction = handlePostAction;
        window.toggleComments = toggleComments;
        window.sendComment = sendComment;
        window.watchAd = watchAd;
        window.cleanupWatched = cleanupWatched;
        window.startTask = startTask;
        window.viewTaskDetails = viewTaskDetails;
        window.viewUserProfile = viewUserProfile;
        window.copyRefLink = copyRefLink;
        window.closeBrowserModal = closeBrowserModal;
        window.closeProfileSection = closeProfileSection;
        window.showToast = showToast;
        window.submitPost = submitPost;

        // Start initialization when DOM is loaded
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>